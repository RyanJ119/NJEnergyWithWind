## Setup

A Python virtual environment (*venv*) is needed in this directory to install TOPFARM and other dependencies. TOPFARM does not use the latest Python version; 3.10.8 has been used here.

In this directory:

1. `python3.10 -m venv .venv` (3.11 works too)
2. `source .venv/bin/activate`
3. `pip3 install pandas matplotlib topfarm`

Additionally, an NREL API key and email is needed to download data. Store this in a text file named `api_key` with the key on the first line and the associated email on the second. An API key can be retrieved here: https://developer.nrel.gov/signup/

Running from the terminal can be made easier with `chmod +x opt.py` and `chmod +x preprocess.py`

## preprocess.py

Downloads and caches wind data, and pre-processes it for use in the optimization process.

Usage: `./preprocess.py DIRECTIONS SPEEDS`

`DIRECTIONS`: number of directions treated as distinct — `SPEEDS`: number of wind speeds treated as distinct. Both parameters are optional and default to 16 and 9 respectively.

`sites/define` contains information about each wind lease area in New Jersey. `sites/define/areas.csv` contains the name and approximate midpoint of each lease area; the images depict each lease area's boundary where each pixel is 600 square metres. `preprocess.py` takes the information in `sites/define` and does the following for each lease area:

1. Traces the boundary of the lease area as a NumPy shape usable by TOPFARM
2. Downloads eight years of hourly wind speed/direction data (approx 13MB per site). Caches it to avoid re-downloading if running `preprocess` again
3. Constructs and saves histogram data for each available altitude as `histo_ALTITUDE.csv`, with frequency of each direction/speed combination
4. Constructs and saves a left-stochastic matrix (column → row) expressing likelihood of each direction/speed transition

Information for a given site `ABCD` will be stored in `sites/ABCD/`

## opt.py

Runs a turbine placement optimization process on a given lease area / altitude.

Usage: `./opt.py LEASE_AREA ALTITUDE`

`LEASE_AREA`: the name of the lease area being optimized (should match the data folder name in `sites/`) — `ALTITUDE`: the altitude of wind data being used, in [10, 20, 40, 60, 80, 100, 120, ..., 200]. Both paremeters are mandatory.

The optimization uses the histogram data created by `preprocess` to weight the optimization value of speeds and directions. Optimization is made with respect to AEP.

## histoviz.py

Displays the wind rose, representing the direction and speed bins used in the histograms generated by `preprocess` for a given lease area / altitude. Serves as a sanity check for `preprocess`.

Usage: `./histoviz.py LEASE_AREA ALTITUDE`